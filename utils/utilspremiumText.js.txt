// utils/premiumText.js
import OpenAI from "openai";

const client = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});

export async function generatePremiumText({ fullName, birthDate, tzolkinDay }) {
  const prompt = `
Ti si starodavni varuh časa in Tzolkin vodič. 
Piši globoko, mistično in premišljeno premium razlago DNEVA. 
Ne uporabljaš astrologije, temveč kolektivno energijo Tzolkin dneva (${tzolkinDay}).

STRUKTURA:
1. Odpri zapis kot živ portal časa, ki govori
2. Razloži kolektivno energijo in učenje dneva
3. Pokaži, kako se energija kaže v občutkih, mislih, dogodkih
4. Predlagaj preprost ritual za harmonijo z energijo dneva
5. Zaključi z refleksivnim vprašanjem ali mislijo
6. Na koncu subtilno omeni možnost globlje osebne razlage dneva (${birthDate})

SLOG:
- mističen, tih, sveti
- brez floskul
- občutek, da govori čas sam
- slovenski jezik
- vsaj 400 besed

Uporabnik: ${fullName}
`;

  const response = await client.chat.completions.create({
    model: "gpt-4o-mini",
    messages: [
      {
        role: "system",
        content: "Ti si starodavni Tzolkin varuh časa in pišeš svete dnevne zapise zavesti."
      },
      {
        role: "user",
        content: prompt
      }
    ],
    temperature: 0.9,
    max_tokens: 1200
  });

  return response.choices[0].message.content;
}
